selector_to_html = {"a[href=\"#crop-images-from-pages-using-the-ocr-coordinates\"]": "<h2 class=\"tippy-header\" style=\"margin-top: 0;\">Crop images from pages using the OCR coordinates<a class=\"headerlink\" href=\"#crop-images-from-pages-using-the-ocr-coordinates\" title=\"Link to this heading\">#</a></h2><p>One thing you might want to do is to crop text blocks or illustrations from the page image using the OCR coordinates. This is certainly possible, but it\u2019s not always straightforward. The problem is that the coordinates in the OCR data can sometimes refer to images at a higher resolution than those you can access through the web interface. If you try and use the coordinates with a lower resolution image you\u2019ll end up cropping out the wrong areas. The solution is to find the resolution of the image used in creating the coordinates and compare it to the one you\u2019ve downloaded. Dividing the width of the low res image by the width of the high-res image will give you a ratio that you can apply to the coordinates to transform them for use with the downloaded image.</p><p>The original page resolutions are usually included in the metadata embedded in the digital journal viewer.</p>", "a[href=\"extract-embedded-metadata.html\"]": "<h1 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">25.3. </span>HOW TO: Extract additional metadata from the digitised resource viewer<a class=\"headerlink\" href=\"#how-to-extract-additional-metadata-from-the-digitised-resource-viewer\" title=\"Link to this heading\">#</a></h1><p>The viewers you use to examine digitised resources in Trove embed some metadata that isn\u2019t available through the Trove API. This includes a JSON-ified version of the item\u2019s MARC record (presumably copied from the NLA catalogue), as well as structural information used by the viewer itself, such as a list of pages in a digitised book.</p><p>This metadata can be useful in a number of different contexts. For example, you can extract the number of pages in a digitised book, then use this number to <a class=\"reference internal\" href=\"download-items-text-images.html\"><span class=\"doc std std-doc\">automatically download the full text or a PDF</span></a>. The GLAM Workbench includes an example where geospatial coordinates are extracted from the MARC data to add to a <a class=\"reference external\" href=\"https://glam-workbench.net/trove-maps/exploring-digitised-maps/\">harvest of digitised maps</a>.</p>", "a[href=\"#extract-blocks-from-the-ocr-data\"]": "<h2 class=\"tippy-header\" style=\"margin-top: 0;\">Extract blocks from the OCR data<a class=\"headerlink\" href=\"#extract-blocks-from-the-ocr-data\" title=\"Link to this heading\">#</a></h2><p>As noted, the OCR data contains <code class=\"docutils literal notranslate\"><span class=\"pre\">ps</span></code> (text) and <code class=\"docutils literal notranslate\"><span class=\"pre\">zs</span></code> (illustration) blocks. The function below will extract the blocks from the data into a list, irrespective of the top-level structure.</p>", "a[href=\"#layout-img\"]": "<figure class=\"align-default\" id=\"layout-img\">\n<a class=\"reference internal image-reference\" href=\"../../_images/6a993faf6173bce8c4cd7a14a038b2c98247bf6ed4e0ee534047a3a7e53fcea1.png\"><img alt=\"../../_images/6a993faf6173bce8c4cd7a14a038b2c98247bf6ed4e0ee534047a3a7e53fcea1.png\" src=\"../../_images/6a993faf6173bce8c4cd7a14a038b2c98247bf6ed4e0ee534047a3a7e53fcea1.png\" style=\"width: 300px;\"/></a>\n<figcaption>\n<p><span class=\"caption-number\">Fig. 25.2 </span><span class=\"caption-text\">OCR block layout of page <a class=\"reference external\" href=\"https://nla.gov.au/nla.obj-326405522\">nla.obj-326405522</a></span><a class=\"headerlink\" href=\"#layout-img\" title=\"Link to this image\">#</a></p>\n</figcaption>\n</figure>", "a[href=\"../../what-is-trove/interfaces.html#interfaces-digitised-journal-viewer\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\">Book and journal viewer<a class=\"headerlink\" href=\"#book-and-journal-viewer\" title=\"Link to this heading\">#</a></h3>", "a[href=\"#nla-obj-375667954\"]": "<figure class=\"align-default\" id=\"nla-obj-375667954\">\n<a class=\"reference internal image-reference\" href=\"../../_images/nla.obj-375667954.jpg\"><img alt=\"../../_images/nla.obj-375667954.jpg\" src=\"../../_images/nla.obj-375667954.jpg\" style=\"height: 400px;\"/></a>\n<figcaption>\n<p><span class=\"caption-number\">Fig. 25.5 </span><span class=\"caption-text\">Complete image of page <a class=\"reference external\" href=\"https://nla.gov.au/nla.obj-375667954\">nla.obj-375667954</a></span><a class=\"headerlink\" href=\"#nla-obj-375667954\" title=\"Link to this image\">#</a></p>\n</figcaption>\n</figure>", "a[href=\"#the-structure-of-the-data\"]": "<h2 class=\"tippy-header\" style=\"margin-top: 0;\">The structure of the data<a class=\"headerlink\" href=\"#the-structure-of-the-data\" title=\"Link to this heading\">#</a></h2><p>The OCR data returned by the API is pretty dense and difficult for humans to parse. Here\u2019s a reformatted snippet that shows the basic structure.</p>", "a[href=\"#how-to-get-and-use-ocr-data-from-a-book-or-periodical-page\"]": "<h1 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">25.4. </span>HOW TO: Get and use OCR data from a book or periodical page<a class=\"headerlink\" href=\"#how-to-get-and-use-ocr-data-from-a-book-or-periodical-page\" title=\"Link to this heading\">#</a></h1><p>The Optical Character Recognition (OCR) process extracts text from images. In doing so, it captures information about the <em>position</em> of each object on the page. This positional information isn\u2019t directly exposed in Trove, but it\u2019s used by the interface. For example, when you view a page in Trove\u2019s <a class=\"reference internal\" href=\"../../what-is-trove/interfaces.html#interfaces-digitised-journal-viewer\"><span class=\"std std-ref\">digital book &amp; journal viewer</span></a> it loads OCR data relating to that page using an internal API.</p><p>To access this API and download the OCR data for any page in a book or periodical you just need the page identifier. This <a class=\"reference external\" href=\"http://nla.gov.au/nla.obj-326405522\">page</a> in <em>Pacific Islands Monthly</em> has the identifier <code class=\"docutils literal notranslate\"><span class=\"pre\">nla.obj-326405522</span></code>. To retrieve the OCR data you just add <code class=\"docutils literal notranslate\"><span class=\"pre\">/ocr</span></code> to the identifier:</p>", "a[href=\"#ill-img\"]": "<figure class=\"align-default\" id=\"ill-img\">\n<a class=\"reference internal image-reference\" href=\"../../_images/d71cc673a8895c8a8e969a3deaceb24e0d568ceef2f77414e94cd1bcd9892239.png\"><img alt=\"../../_images/d71cc673a8895c8a8e969a3deaceb24e0d568ceef2f77414e94cd1bcd9892239.png\" src=\"../../_images/d71cc673a8895c8a8e969a3deaceb24e0d568ceef2f77414e94cd1bcd9892239.png\" style=\"height: 400px;\"/></a>\n<figcaption>\n<p><span class=\"caption-number\">Fig. 25.4 </span><span class=\"caption-text\">Cropped illustration</span><a class=\"headerlink\" href=\"#ill-img\" title=\"Link to this image\">#</a></p>\n</figcaption>\n</figure>", "a[href=\"#redacted-image\"]": "<figure class=\"align-default\" id=\"redacted-image\">\n<a class=\"reference internal image-reference\" href=\"../../_images/9b420d60176dd1dc22a794b7bd82e88e5f0e6765b9aff15c0961fe9085f1295d.png\"><img alt=\"../../_images/9b420d60176dd1dc22a794b7bd82e88e5f0e6765b9aff15c0961fe9085f1295d.png\" src=\"../../_images/9b420d60176dd1dc22a794b7bd82e88e5f0e6765b9aff15c0961fe9085f1295d.png\" style=\"width: 500px;\"/></a>\n<figcaption>\n<p><span class=\"caption-number\">Fig. 25.6 </span><span class=\"caption-text\">Some randomly-generated redaction art!</span><a class=\"headerlink\" href=\"#redacted-image\" title=\"Link to this image\">#</a></p>\n</figcaption>\n</figure>", "a[href=\"../../newspapers-and-gazettes/how-to/get-ocr-coordinates.html\"]": "<h1 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">18.2. </span>HOW TO: Get information about the position of OCRd newspaper text<a class=\"headerlink\" href=\"#how-to-get-information-about-the-position-of-ocrd-newspaper-text\" title=\"Link to this heading\">#</a></h1><p>The OCR process not only extracts text from an image, it generates coordinates that document the position of each piece of text within the parent image. You could use this information to crop an image of the OCRd text out of the parent image. In the case of digitised newspapers, this sort of positional information could help you explore the layout and contents of newspaper pages and how this changes over time.</p><p>No positional information is available from the Trove API, however, there is some embedded within the web site. If you view the source of a newspaper article\u2019s web page, you\u2019ll find a number of <code class=\"docutils literal notranslate\"><span class=\"pre\">&lt;input&gt;</span></code> tags like this:</p>", "a[href=\"#visualise-page-layout\"]": "<h2 class=\"tippy-header\" style=\"margin-top: 0;\">Visualise page layout<a class=\"headerlink\" href=\"#visualise-page-layout\" title=\"Link to this heading\">#</a></h2><p>The most interesting thing about the OCR data is the positional information. It enables us to explore the structure and layout of published pages, rather than just their content. Here\u2019s a simple example which visualises the position of each text and illustration block. It uses the OCR data downloaded above, using the block coordinates to draw coloured rectangles on a blank canvas.</p>", "a[href=\"#play-with-words\"]": "<h2 class=\"tippy-header\" style=\"margin-top: 0;\">Play with words<a class=\"headerlink\" href=\"#play-with-words\" title=\"Link to this heading\">#</a></h2><p>As noted above, the OCR data includes coordinates for all the page objects, including every word. You could use this to crop printed words from pages and create your own scissors and paste, \u2018ransom note\u2019 style messages. Or you could attempt some redaction art.</p><p>The example below \u2018redacts\u2019 random words from <a class=\"reference external\" href=\"http://nla.gov.au/nla.obj-3083661207\">a page</a> of the <em>Australian Poetry Annual</em>. It extracts the coordinates of every word on the page, selects twenty at random, and then uses the coordinates to draw black boxes over the words in the page image.</p>", "a[href=\"#nla-obj-326405522\"]": "<figure class=\"align-default\" id=\"nla-obj-326405522\">\n<a class=\"reference internal image-reference\" href=\"../../_images/nla.obj-326405522.jpg\"><img alt=\"../../_images/nla.obj-326405522.jpg\" src=\"../../_images/nla.obj-326405522.jpg\" style=\"width: 300px;\"/></a>\n<figcaption>\n<p><span class=\"caption-number\">Fig. 25.3 </span><span class=\"caption-text\">Image of page <a class=\"reference external\" href=\"https://nla.gov.au/nla.obj-326405522\">nla.obj-326405522</a></span><a class=\"headerlink\" href=\"#nla-obj-326405522\" title=\"Link to this image\">#</a></p>\n</figcaption>\n</figure>"}
skip_classes = ["headerlink", "sd-stretched-link", "sd-rounded-pill"]

window.onload = function () {
    for (const [select, tip_html] of Object.entries(selector_to_html)) {
        const links = document.querySelectorAll(`article.bd-article ${select}`);
        for (const link of links) {
            if (skip_classes.some(c => link.classList.contains(c))) {
                continue;
            }

            tippy(link, {
                content: tip_html,
                allowHTML: true,
                arrow: true,
                placement: 'auto-start', maxWidth: 500, interactive: false,

            });
        };
    };
    console.log("tippy tips loaded!");
};
