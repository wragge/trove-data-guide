selector_to_html = {"a[href=\"#id3\"]": "<h2 class=\"tippy-header\" style=\"margin-top: 0;\">Metadata<a class=\"headerlink\" href=\"#id3\" title=\"Link to this heading\">#</a></h2><h3>Understanding identifiers<a class=\"headerlink\" href=\"#understanding-identifiers\" title=\"Link to this heading\">#</a></h3>", "a[href=\"#text\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\">Text<a class=\"headerlink\" href=\"#text\" title=\"Link to this heading\">#</a></h3><p>Via API</p>", "a[href=\"#metadata\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\">Metadata<a class=\"headerlink\" href=\"#metadata\" title=\"Link to this heading\">#</a></h3><p><code class=\"docutils literal notranslate\"><span class=\"pre\">/search</span></code> in <code class=\"docutils literal notranslate\"><span class=\"pre\">magazine</span></code> category and <code class=\"docutils literal notranslate\"><span class=\"pre\">/work</span></code> endpoints</p><p><code class=\"docutils literal notranslate\"><span class=\"pre\">bibliographicCitation</span></code> in article records has structured publication metadata</p>", "a[href=\"#images\"]": "<h2 class=\"tippy-header\" style=\"margin-top: 0;\">Images<a class=\"headerlink\" href=\"#images\" title=\"Link to this heading\">#</a></h2>", "a[href=\"#understanding-identifiers\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\">Understanding identifiers<a class=\"headerlink\" href=\"#understanding-identifiers\" title=\"Link to this heading\">#</a></h3>", "a[href=\"../how-to/download-items-text-images.html\"]": "<h1 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">23.2. </span>HOW TO: Automate the download of digitised items as text, images, or PDFs<a class=\"headerlink\" href=\"#how-to-automate-the-download-of-digitised-items-as-text-images-or-pdfs\" title=\"Link to this heading\">#</a></h1><p>You can download text, images, and PDFs from individual digitised items <a class=\"reference internal\" href=\"../../accessing-data/using-web-interface.html\"><span class=\"std std-doc\">using the Trove web interface</span></a>. But only the text of periodical articles is available for machine access through the Trove API. This makes it difficult to assemble datasets, or build processing pipelines involving digitised resources. This page documents a series of work arounds that enable you to automate the download of digitised items as text, images, or PDFs.</p>", "a[href=\"#magazine-title-id\"]": "<h4 class=\"tippy-header\" style=\"margin-top: 0;\"><code class=\"docutils literal notranslate\"><span class=\"pre\">/magazine/title/[ID]</span></code><a class=\"headerlink\" href=\"#magazine-title-id\" title=\"Link to this heading\">#</a></h4><p>Example issue:</p>", "a[href=\"#data-problems-and-workarounds\"]": "<h4 class=\"tippy-header\" style=\"margin-top: 0;\">Data problems and workarounds<a class=\"headerlink\" href=\"#data-problems-and-workarounds\" title=\"Link to this heading\">#</a></h4><p>By converting the list of titles into a dataframe, you can explore the contents.</p><p>How many titles are there?</p>", "a[href=\"#id7\"]": "<h2 class=\"tippy-header\" style=\"margin-top: 0;\">Text<a class=\"headerlink\" href=\"#id7\" title=\"Link to this heading\">#</a></h2><p>There are three ways of getting OCRd text from periodicals:</p>", "a[href=\"#id1\"]": "<h2 class=\"tippy-header\" style=\"margin-top: 0;\">Issues<a class=\"headerlink\" href=\"#id1\" title=\"Link to this heading\">#</a></h2><h3>Metadata<a class=\"headerlink\" href=\"#id2\" title=\"Link to this heading\">#</a></h3><p>API provides <code class=\"docutils literal notranslate\"><span class=\"pre\">/magazine/titles</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">/magazine/title/[ID]</span></code> endpoints</p><p>Been prodding the new <code class=\"docutils literal notranslate\"><span class=\"pre\">/magazine/title</span></code> endpoint that was added to #Trove API v3. It provides details on periodical titles and issues (other than newspapers). So it\u2019s very useful, but also very not\u2026</p>", "a[href=\"#id6\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\">Articles<a class=\"headerlink\" href=\"#id6\" title=\"Link to this heading\">#</a></h3>", "a[href=\"#images-and-pdfs\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\">Images and PDFs<a class=\"headerlink\" href=\"#images-and-pdfs\" title=\"Link to this heading\">#</a></h3><p>Page images</p>", "a[href=\"#format-periodical-and-nla-obj\"]": "<h4 class=\"tippy-header\" style=\"margin-top: 0;\">Format <code class=\"docutils literal notranslate\"><span class=\"pre\">periodical</span></code> and \u201cnla.obj\u201d<a class=\"headerlink\" href=\"#format-periodical-and-nla-obj\" title=\"Link to this heading\">#</a></h4><p>There are 2,500 titles in the title endpoint, but only about 1,000 when you search for <code class=\"docutils literal notranslate\"><span class=\"pre\">\"nla.obj\"</span></code> &amp; <code class=\"docutils literal notranslate\"><span class=\"pre\">l-format=periodical</span></code>. Is there any way to reconcile? Is it because of PP?</p><p>Check by getting ids from title endpoint, then extracting embedded metadata? Will that help?</p>", "a[href=\"#get-text-from-an-internal-api-that-provides-ocrd-text-and-layout-information\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\">Get text from an internal API that provides OCRd text and layout information<a class=\"headerlink\" href=\"#get-text-from-an-internal-api-that-provides-ocrd-text-and-layout-information\" title=\"Link to this heading\">#</a></h3><p>When Trove\u2019s <a class=\"reference internal\" href=\"../../what-is-trove/interfaces.html#interfaces-digitised-journal-viewer\"><span class=\"std std-ref\">digital book &amp; journal viewer</span></a> displays a page, it loads OCR data from an internal API. This data includes both the OCRd text and the position of every block, line, and word of the text. If all you want is the raw text, you\u2019re better off using the method above, but if you\u2019re interested in the position of the text on the page then you might find this a useful approach.</p><p>To request the OCR data all you need is the page identifier</p>", "a[href=\"#finding-missing-issues\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\">Finding missing issues<a class=\"headerlink\" href=\"#finding-missing-issues\" title=\"Link to this heading\">#</a></h3>", "a[href=\"#periodical-titles\"]": "<h2 class=\"tippy-header\" style=\"margin-top: 0;\">Periodical titles<a class=\"headerlink\" href=\"#periodical-titles\" title=\"Link to this heading\">#</a></h2><p>Finding out which periodicals in Trove have been digitised is not straightforward. There are two basic approaches:</p>", "a[href=\"#magazine-titles\"]": "<h4 class=\"tippy-header\" style=\"margin-top: 0;\"><code class=\"docutils literal notranslate\"><span class=\"pre\">/magazine/titles</span></code><a class=\"headerlink\" href=\"#magazine-titles\" title=\"Link to this heading\">#</a></h4><p>Example record:</p>", "a[href=\"#accessing-data-from-periodicals\"]": "<h1 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">20.2. </span>Accessing data from periodicals<a class=\"headerlink\" href=\"#accessing-data-from-periodicals\" title=\"Link to this heading\">#</a></h1><h2>What periodicals have been digitised?<a class=\"headerlink\" href=\"#what-periodicals-have-been-digitised\" title=\"Link to this heading\">#</a></h2><p>Search for <a class=\"reference external\" href=\"https://trove.nla.gov.au/search/category/books?keyword=%22nla.obj%22%20NOT%20series%3A%22Parliamentary%20paper%20%28Australia.%20Parliament%29%22%20NOT%20nuc%3A%22ANL%3ANED%22&amp;amp;l-format=Periodical&amp;amp;l-availability=y\">\u201cnla.obj\u201d NOT series:\u201cParliamentary paper (Australia. Parliament)\u201d NOT nuc:\u201cANL:NED\u201d and <code class=\"docutils literal notranslate\"><span class=\"pre\">l-format=Periodical</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">l-availability=y</span></code></a> in different categories (mostly B&amp;L) : 968 results</p><p>API provides another option</p>", "a[href=\"#id4\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\">Issues<a class=\"headerlink\" href=\"#id4\" title=\"Link to this heading\">#</a></h3>", "a[href=\"#articles\"]": "<h2 class=\"tippy-header\" style=\"margin-top: 0;\">Articles<a class=\"headerlink\" href=\"#articles\" title=\"Link to this heading\">#</a></h2><h3>Metadata<a class=\"headerlink\" href=\"#metadata\" title=\"Link to this heading\">#</a></h3><p><code class=\"docutils literal notranslate\"><span class=\"pre\">/search</span></code> in <code class=\"docutils literal notranslate\"><span class=\"pre\">magazine</span></code> category and <code class=\"docutils literal notranslate\"><span class=\"pre\">/work</span></code> endpoints</p><p><code class=\"docutils literal notranslate\"><span class=\"pre\">bibliographicCitation</span></code> in article records has structured publication metadata</p>", "a[href=\"../how-to/extract-embedded-metadata.html\"]": "<h1 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">23.3. </span>HOW TO: Extract additional metadata from the web page of a digitised work<a class=\"headerlink\" href=\"#how-to-extract-additional-metadata-from-the-web-page-of-a-digitised-work\" title=\"Link to this heading\">#</a></h1><p>The viewers you use to examine digitised resources in Trove embed some metadata that isn\u2019t available through the Trove API. This includes a JSON-ified version of the item\u2019s MARC record (presumably copied from the NLA catalogue), as well as structural information used by the viewer itself, such as a list of pages in a digitised book.</p><p>This metadata can be useful in a number of different contexts. For example, you can extract the number of pages in a digitised book, then use this number to <a class=\"reference internal\" href=\"../how-to/download-items-text-images.html\"><span class=\"doc std std-doc\">automatically download the full text or a PDF</span></a>. The GLAM Workbench includes an example where geospatial coordinates are extracted from the MARC data to add to a <a class=\"reference external\" href=\"https://glam-workbench.net/trove-maps/exploring-digitised-maps/\">harvest of digitised maps</a>.</p>", "a[href=\"#id2\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\">Metadata<a class=\"headerlink\" href=\"#id2\" title=\"Link to this heading\">#</a></h3><p>API provides <code class=\"docutils literal notranslate\"><span class=\"pre\">/magazine/titles</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">/magazine/title/[ID]</span></code> endpoints</p><p>Been prodding the new <code class=\"docutils literal notranslate\"><span class=\"pre\">/magazine/title</span></code> endpoint that was added to #Trove API v3. It provides details on periodical titles and issues (other than newspapers). So it\u2019s very useful, but also very not\u2026</p>", "a[href=\"#get-details-of-an-individual-title\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\">Get details of an individual title<a class=\"headerlink\" href=\"#get-details-of-an-individual-title\" title=\"Link to this heading\">#</a></h3><p>You can use the <code class=\"docutils literal notranslate\"><span class=\"pre\">magazine/title</span></code> endpoint to retrieve information about an individual periodical title. You can supply either an <code class=\"docutils literal notranslate\"><span class=\"pre\">nla.obj</span></code> identifier or a numeric work identifier. For example, to get details about the <a class=\"reference external\" href=\"https://trove.nla.gov.au/work/10411388\"><em>Journal of Soil Conservation</em></a> you can either use it\u2019s work identifier <code class=\"docutils literal notranslate\"><span class=\"pre\">10411388</span></code>:</p><p><code class=\"docutils literal notranslate\"><span class=\"pre\">https://api.trove.nla.gov.au/v3/magazine/title/10411388?encoding=json</span></code></p>", "a[href=\"#illustrations\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\">Illustrations<a class=\"headerlink\" href=\"#illustrations\" title=\"Link to this heading\">#</a></h3>", "a[href=\"#data-problems\"]": "<h4 class=\"tippy-header\" style=\"margin-top: 0;\">Data problems<a class=\"headerlink\" href=\"#data-problems\" title=\"Link to this heading\">#</a></h4><p>Once you start working with the data from the <code class=\"docutils literal notranslate\"><span class=\"pre\">magazine/titles</span></code> endpoint you might notice other problems, such as:</p>", "a[href=\"#id5\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\">Pages<a class=\"headerlink\" href=\"#id5\" title=\"Link to this heading\">#</a></h3>", "a[href=\"#find-the-number-of-issues-per-year\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\">Find the number of issues per year<a class=\"headerlink\" href=\"#find-the-number-of-issues-per-year\" title=\"Link to this heading\">#</a></h3><p>You can find the number of digitised issues per year by setting the <code class=\"docutils literal notranslate\"><span class=\"pre\">include</span></code> parameter to <code class=\"docutils literal notranslate\"><span class=\"pre\">years</span></code>. The data returned will include a list of years for which digitised issues are available, and the number of issues available each year. For example, to get issue counts from the <em>Australasian pocket almanack</em> (<code class=\"docutils literal notranslate\"><span class=\"pre\">nla.obj-2967431735</span></code>), you\u2019d request:</p><p><code class=\"docutils literal notranslate\"><span class=\"pre\">https://api.trove.nla.gov.au/v3/magazine/title/nla.obj-2967431735?encoding=json&amp;include=years</span></code></p>", "a[href=\"../../what-is-trove/interfaces.html#interfaces-digitised-collection-viewer\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\">Collection viewer<a class=\"headerlink\" href=\"#collection-viewer\" title=\"Link to this heading\">#</a></h3><p>The <strong>Browse this collection</strong> button opens a modal window that lets you navigate through the items in the collection. This list is generated by an internal web request that returns an HTML fragment. You can <a class=\"reference internal\" href=\"../../other-digitised-resources/how-to/get-collection-items.html\"><span class=\"doc std std-doc\">use these fragments to assemble machine-readable data</span></a> about the items in a collection.</p>", "a[href=\"#what-periodicals-have-been-digitised\"]": "<h2 class=\"tippy-header\" style=\"margin-top: 0;\">What periodicals have been digitised?<a class=\"headerlink\" href=\"#what-periodicals-have-been-digitised\" title=\"Link to this heading\">#</a></h2><p>Search for <a class=\"reference external\" href=\"https://trove.nla.gov.au/search/category/books?keyword=%22nla.obj%22%20NOT%20series%3A%22Parliamentary%20paper%20%28Australia.%20Parliament%29%22%20NOT%20nuc%3A%22ANL%3ANED%22&amp;amp;l-format=Periodical&amp;amp;l-availability=y\">\u201cnla.obj\u201d NOT series:\u201cParliamentary paper (Australia. Parliament)\u201d NOT nuc:\u201cANL:NED\u201d and <code class=\"docutils literal notranslate\"><span class=\"pre\">l-format=Periodical</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">l-availability=y</span></code></a> in different categories (mostly B&amp;L) : 968 results</p><p>API provides another option</p>", "a[href=\"#get-article-text-from-the-trove-api\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\">Get article text from the Trove API<a class=\"headerlink\" href=\"#get-article-text-from-the-trove-api\" title=\"Link to this heading\">#</a></h3><p>You can get the OCRd text of articles in the <em>Magazines &amp; Newsletters</em> category using the Trove API, but there\u2019s a couple of tricks.</p><p>The OCRd text is only included in <em>version</em> records rather than the parent <em>work</em> records. But, by default, the API only returns the <em>work</em> level records. To include the OCRd text you need to ask the API to add the versions by setting the <code class=\"docutils literal notranslate\"><span class=\"pre\">include</span></code> parameter to <code class=\"docutils literal notranslate\"><span class=\"pre\">workVersions</span></code> when constructing your request.</p>", "a[href=\"#titles\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\">Titles<a class=\"headerlink\" href=\"#titles\" title=\"Link to this heading\">#</a></h3>", "a[href=\"#removing-parliamentary-papers\"]": "<h4 class=\"tippy-header\" style=\"margin-top: 0;\">Removing parliamentary papers<a class=\"headerlink\" href=\"#removing-parliamentary-papers\" title=\"Link to this heading\">#</a></h4><p>To get a sense of the types of periodicals in the dataset you can look at the titles. You\u2019ll see that many of them are just called \u2018Annual report\u2019.</p>", "a[href=\"#download-ocrd-text-from-pages-and-issues\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\">Download OCRd text from pages and issues<a class=\"headerlink\" href=\"#download-ocrd-text-from-pages-and-issues\" title=\"Link to this heading\">#</a></h3><p>You can download OCRd text from periodical issues and pages using the web interface. To automate this process you can mimic the behaviour of the download button. Full details are available in <a class=\"reference internal\" href=\"../how-to/download-items-text-images.html\"><span class=\"std std-doc\">HOW TO: Automate the download of digitised items as text, images, or PDFs</span></a>, but here\u2019s a quick summary.</p>", "a[href=\"../../what-is-trove/interfaces.html#interfaces-digitised-journal-viewer\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\">Book and journal viewer<a class=\"headerlink\" href=\"#book-and-journal-viewer\" title=\"Link to this heading\">#</a></h3>", "a[href=\"#pages\"]": "<h2 class=\"tippy-header\" style=\"margin-top: 0;\">Pages<a class=\"headerlink\" href=\"#pages\" title=\"Link to this heading\">#</a></h2><h3>Images and PDFs<a class=\"headerlink\" href=\"#images-and-pdfs\" title=\"Link to this heading\">#</a></h3><p>Page images</p>", "a[href=\"#removing-duplicates\"]": "<h4 class=\"tippy-header\" style=\"margin-top: 0;\">Removing duplicates<a class=\"headerlink\" href=\"#removing-duplicates\" title=\"Link to this heading\">#</a></h4><p>Unfortunately the <code class=\"docutils literal notranslate\"><span class=\"pre\">magazine/titles</span></code> endpoint data includes a significant number of duplicate records. Here\u2019s some examples.</p>", "a[href=\"#get-a-list-of-individual-issues\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\">Get a list of individual issues<a class=\"headerlink\" href=\"#get-a-list-of-individual-issues\" title=\"Link to this heading\">#</a></h3><p>You can get details of individual issues from the <code class=\"docutils literal notranslate\"><span class=\"pre\">magazines/title</span></code> API endpoint by setting the <code class=\"docutils literal notranslate\"><span class=\"pre\">include</span></code> parameter to <code class=\"docutils literal notranslate\"><span class=\"pre\">years</span></code> and adding the <code class=\"docutils literal notranslate\"><span class=\"pre\">range</span></code> parameter to specify a date range. The <code class=\"docutils literal notranslate\"><span class=\"pre\">range</span></code> parameter needs to be in the format <code class=\"docutils literal notranslate\"><span class=\"pre\">YYYYMMDD-YYYYMMDD</span></code>. For example, to retrieve details of issues from 1920 to 1950, you\u2019d use a <code class=\"docutils literal notranslate\"><span class=\"pre\">range</span></code> value of <code class=\"docutils literal notranslate\"><span class=\"pre\">19200101-19501231</span></code>.</p><p>If the number of issues is fairly small, you can just use dummy dates to set the range well beyond the limits of the periodical, something like <code class=\"docutils literal notranslate\"><span class=\"pre\">18000101-21001231</span></code> for example. That means you\u2019ll get everything at once.</p>", "a[href=\"#harvest-all-of-the-records\"]": "<h4 class=\"tippy-header\" style=\"margin-top: 0;\">Harvest all of the records<a class=\"headerlink\" href=\"#harvest-all-of-the-records\" title=\"Link to this heading\">#</a></h4><p>To harvest details of <em>all</em> titles, you need to work your way through the complete dataset by using the <code class=\"docutils literal notranslate\"><span class=\"pre\">offset</span></code> parameter to move each request forward to the next group of titles. So if <code class=\"docutils literal notranslate\"><span class=\"pre\">limit</span></code> is set to <code class=\"docutils literal notranslate\"><span class=\"pre\">100</span></code>, your first request would have an <code class=\"docutils literal notranslate\"><span class=\"pre\">offset</span></code> value of <code class=\"docutils literal notranslate\"><span class=\"pre\">0</span></code>, and your second request would have an <code class=\"docutils literal notranslate\"><span class=\"pre\">offset</span></code> value of <code class=\"docutils literal notranslate\"><span class=\"pre\">100</span></code>. You\u2019d then keep incrementing the <code class=\"docutils literal notranslate\"><span class=\"pre\">offset</span></code> value by 100 until you reach the end of the dataset. Here\u2019s a full example.</p>", "a[href=\"#issues\"]": "<h2 class=\"tippy-header\" style=\"margin-top: 0;\">Issues<a class=\"headerlink\" href=\"#issues\" title=\"Link to this heading\">#</a></h2><p>You can use the <code class=\"docutils literal notranslate\"><span class=\"pre\">magazine/title</span></code> API endpoint to retrieve information about issues of a periodical that have been digitised and are available through Trove. As described above, you can get details about an individual periodical using either it\u2019s work identifier or <code class=\"docutils literal notranslate\"><span class=\"pre\">nla.obj</span></code> identifier.</p>", "a[href=\"#using-the-magazine-titles-api-endpoint\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\">Using the <code class=\"docutils literal notranslate\"><span class=\"pre\">magazine/titles</span></code> API endpoint<a class=\"headerlink\" href=\"#using-the-magazine-titles-api-endpoint\" title=\"Link to this heading\">#</a></h3><p>The <code class=\"docutils literal notranslate\"><span class=\"pre\">magazine/titles</span></code> endpoint was introduced in version 3 of the Trove API. If you send a request to the <code class=\"docutils literal notranslate\"><span class=\"pre\">magazine/titles</span></code> you get back the first group of periodical titles. The maximum number of titles per request is 100, which you can set using the <code class=\"docutils literal notranslate\"><span class=\"pre\">limit</span></code> parameter.</p><p><a class=\"reference external\" href=\"https://troveconsole.herokuapp.com/v3/?url=https%3A%2F%2Fapi.trove.nla.gov.au%2Fv3%2Fmagazine%2Ftitles%3Fencoding%3Djson%26limit%3D100&amp;amp;comment=\"><img alt=\"Try it!\" src=\"https://troveconsole.herokuapp.com/static/img/try-trove-api-console.svg\"/></a></p>"}
skip_classes = ["headerlink", "sd-stretched-link", "sd-rounded-pill"]

window.onload = function () {
    for (const [select, tip_html] of Object.entries(selector_to_html)) {
        const links = document.querySelectorAll(`article.bd-article ${select}`);
        for (const link of links) {
            if (skip_classes.some(c => link.classList.contains(c))) {
                continue;
            }

            tippy(link, {
                content: tip_html,
                allowHTML: true,
                arrow: true,
                placement: 'auto-start', maxWidth: 500, interactive: false,

            });
        };
    };
    console.log("tippy tips loaded!");
};
